(()=>{var w=(()=>{let m='<span class="spinner-border spinner-border-sm my-0 ms-0 me-1 p-0" style="height: 0.8rem; width: 0.8rem;"></span>',b=d=>String(d).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),y=(d,g,k=.05)=>new Promise(B=>{let q=parseFloat(d.style.opacity),c=g?1:0,p=()=>{q+=g?k:-k,q=Math.max(0,Math.min(1,q)),d.style.opacity=q.toFixed(2),g&&q>=c||!g&&q<=c?(d.style.opacity=c.toString(),B(d)):requestAnimationFrame(p)};requestAnimationFrame(p)}),r=(d,g)=>{let k=null;k=setTimeout(()=>{d(),clearTimeout(k),k=null},g)};return{loader:m,copy:async(d,g=null,k=1500)=>{let B=d.getAttribute("data-copy");if(!B||B.length===0){alert("Nothing to copy");return}d.disabled=!0;try{await navigator.clipboard.writeText(B)}catch{d.disabled=!1,alert("Failed to copy");return}let q=d.innerHTML;d.innerHTML=g||'<i class="fa-solid fa-check"></i>',r(()=>{d.disabled=!1,d.innerHTML=q},k)},timeOut:r,debounce:(d,g)=>{let k=null;return(...B)=>{clearTimeout(k),k=setTimeout(()=>d(...B),g)}},escapeHtml:b,base64Encode:d=>{let k=new TextEncoder().encode(d);return window.btoa(String.fromCharCode(...k))},base64Decode:d=>{let g=new TextDecoder,k=Uint8Array.from(window.atob(d),B=>B.charCodeAt(0));return g.decode(k)},disableButton:(d,g="Loading")=>{d.disabled=!0;let k=d.innerHTML;return d.innerHTML=m+g,{restore:()=>{d.innerHTML=k,d.disabled=!1}}},disableCheckbox:d=>{d.disabled=!0;let g=document.querySelector(`label[for="${d.id}"]`),k=g.innerHTML;return g.innerHTML=m+k,{restore:()=>{g.innerHTML=k,d.disabled=!1}}},parseUserAgent:d=>{let g=[{type:"Mobile",regex:/Android.*Mobile|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i},{type:"Tablet",regex:/iPad|Android(?!.*Mobile)|Tablet/i},{type:"Desktop",regex:/Windows NT|Macintosh|Linux/i}],k=[{name:"Chrome",regex:/Chrome|CriOS/i},{name:"Safari",regex:/Safari/i},{name:"Edge",regex:/Edg|Edge/i},{name:"Firefox",regex:/Firefox|FxiOS/i},{name:"Opera",regex:/Opera|OPR/i},{name:"Internet Explorer",regex:/MSIE|Trident/i}],B=[{name:"Windows",regex:/Windows NT ([\d.]+)/i},{name:"MacOS",regex:/Mac OS X ([\d_]+)/i},{name:"Android",regex:/Android ([\d.]+)/i},{name:"iOS",regex:/OS ([\d_]+) like Mac OS X/i},{name:"Linux",regex:/Linux/i}],q=g.find(a=>a.regex.test(d))?.type||"Unknown",c=k.find(a=>a.regex.test(d))?.name||"Unknown",p=B.find(a=>a.regex.test(d)),$=p&&d.match(p.regex)?.[1]?.replace(/_/g,".")||"",N=p?p.name:"Unknown";return $=$?`${N} ${$}`:N,`${c} ${q} ${$}`},changeOpacity:y}})();var W={tab:y=>window.bootstrap.Tab.getOrCreateInstance(document.getElementById(y)),modal:y=>window.bootstrap.Modal.getOrCreateInstance(document.getElementById(y))};var O=(()=>{let m=(g,k,B)=>({code:g,data:k,error:B}),b=(g=0)=>({love:g}),y=({uuid:g,own:k,name:B,presence:q,comment:c,created_at:p,is_admin:$,gif_url:N,ip:a,user_agent:n,comments:t,like:o})=>({uuid:g,own:k,name:B,presence:q,comment:c,created_at:p,is_admin:$??!1,gif_url:N,ip:a,user_agent:n,comments:t?.map(y)??[],like:b(o?.love??0)});return{uuidResponse:({uuid:g})=>({uuid:g}),baseResponse:m,tokenResponse:({token:g})=>({token:g}),statusResponse:({status:g})=>({status:g}),commentResponse:({name:g,presence:k,comment:B,is_admin:q,gif_url:c,created_at:p})=>({name:g,presence:k,comment:B,is_admin:q,gif_url:c,created_at:p}),likeCommentResponse:b,getCommentResponse:y,getCommentsResponse:g=>g.map(y),commentShowMore:(g,k=!1)=>({uuid:g,show:k}),postCommentRequest:(g,k,B,q,c)=>({id:g,name:k,presence:B,comment:q,gif_id:c}),postSessionRequest:(g,k)=>({email:g,password:k}),updateCommentRequest:(g,k,B)=>({presence:g,comment:k,gif_id:B})}})();var C=m=>{let b=(l=null)=>{let u=JSON.parse(localStorage.getItem(m));return l?u[String(l)]:u},y=(l,u)=>{let I=b();I[String(l)]=u,localStorage.setItem(m,JSON.stringify(I))},r=l=>Object.keys(b()).includes(String(l)),h=l=>{if(!r(l))return;let u=b();delete u[String(l)],localStorage.setItem(m,JSON.stringify(u))},i=()=>localStorage.setItem(m,"{}");return localStorage.getItem(m)||i(),{set:y,get:b,has:r,clear:i,unset:h}};var z="GET",X="PUT",K="POST",G="PATCH",te="DELETE",V=200,Y=201,re=500,_=(m,b)=>{let y=new AbortController,r=document.body.getAttribute("data-url"),h={signal:y.signal,method:String(m).toUpperCase(),headers:new Headers({Accept:"application/json","Content-Type":"application/json"})};return window.addEventListener("offline",()=>y.abort()),window.addEventListener("popstate",()=>y.abort()),window.addEventListener("beforeunload",()=>y.abort()),r&&r.slice(-1)==="/"&&(r=r.slice(0,-1)),{send(i=null){return fetch(r+b,h).then(l=>l.json().then(u=>{if(l.status>=re&&(u.message??u[0]))throw new Error(u.message??u[0]);if(u.error)throw new Error(u.error[0]);return i&&(u.data=i(u.data)),O.baseResponse(u.code,u.data,u.error)})).catch(l=>{if(l.name==="AbortError")return console.warn("Fetch abort:",l),l;throw alert(l),new Error(l)})},download(){return fetch(r+b,h).then(i=>{if(i.status!==V)return!1;let l=document.querySelector("a[download]");l&&document.body.removeChild(l);let u=i.headers.get("content-disposition")?.match(/filename="(.+)"/)?.[1]??"download.csv";return i.blob().then(I=>{let T=document.createElement("a"),M=window.URL.createObjectURL(I);return T.href=M,T.download=u,document.body.appendChild(T),T.click(),document.body.removeChild(T),window.URL.revokeObjectURL(M),!0})}).catch(i=>{if(i.name==="AbortError")return console.warn("Fetch abort:",i),i;throw alert(i),new Error(i)})},withCancel(i){return(async()=>(await i,y.abort()))(),this},default(i=null){return h.headers=new Headers(i??{}),fetch(b,h)},token(i){return i.split(".").length===3?(h.headers.append("Authorization","Bearer "+i),this):(h.headers.append("x-access-key",i),this)},body(i){return h.body=JSON.stringify(i),this}}};var x=(()=>{let m=null,b=()=>m.get("token"),y=T=>m.set("token",T),r=T=>_(K,"/api/session").body(T).send(O.tokenResponse).then(M=>(M.code===V&&y(M.data.token),M.code===V),()=>!1),h=()=>m.unset("token"),i=()=>String(b()??".").split(".").length===3;return{init:()=>{m=C("session")},guest:()=>_(z,"/api/config").token(b()).send().then(T=>{if(T.code!==V)throw new Error("failed to get config.");let M=C("config");for(let[d,g]of Object.entries(T.data))M.set(d,g);return T}),login:r,logout:h,decode:()=>{if(!i())return null;try{return JSON.parse(window.atob(b().split(".")[1]))}catch{return null}},isAdmin:i,setToken:y,getToken:b}})();var J=(()=>{let m=null,b=async l=>{let u=w.disableButton(l),I=document.getElementById("loginEmail"),T=document.getElementById("loginPassword");I.disabled=!0,T.disabled=!0,await x.login(O.postSessionRequest(I.value,T.value))&&(I.value=null,T.value=null,W.modal("mainModal").hide()),u.restore(),I.disabled=!1,T.disabled=!1},y=()=>{m.clear(),x.logout(),W.modal("mainModal").show()};return{init:()=>{m=C("user")},login:b,clearSession:y,getDetailUser:()=>_(z,"/api/user").token(x.getToken()).send().then(l=>{if(l.code!==V)throw new Error("failed to get user.");return Object.entries(l.data).forEach(([u,I])=>m.set(u,I)),l},l=>(y(),l)),getUserStorage:()=>m}})();var ne=(()=>{let m=(r,h)=>{document.querySelectorAll(".navbar button").forEach(i=>{i.classList.contains("active")&&i.classList.remove("active")}),W.tab(h).show(),r.classList.add("active")};return{buttonNavHome:r=>{m(r,"button-home")},buttonNavSetting:r=>{m(r,"button-setting")}}})();var Q=(()=>{let m={"#000000":"#ffffff","#ffffff":"#000000","#212529":"#f8f9fa","#f8f9fa":"#212529"},b=["#ffffff","#f8f9fa"],y=["#000000","#212529"],r=!1,h=null,i=null,l=()=>h.set("active","light"),u=()=>h.set("active","dark"),I=c=>{let p=i.getAttribute("content");i.setAttribute("content",c.some($=>$===p)?m[p]:p)},T=()=>{l(),document.documentElement.setAttribute("data-bs-theme","light"),I(y)},M=()=>{u(),document.documentElement.setAttribute("data-bs-theme","dark"),I(b)},d=(c=null,p=null)=>{let $=h.get("active")==="dark";return c&&p?$?c:p:$};return{init:()=>{switch(h=C("theme"),i=document.querySelector('meta[name="theme-color"]'),h.has("active")||(window.matchMedia("(prefers-color-scheme: dark)").matches?u():l()),document.documentElement.getAttribute("data-bs-theme")){case"dark":u();break;case"light":l();break;default:r=!0}d()?M():T()},spyTop:()=>{let c=$=>$.filter(N=>N.isIntersecting).forEach(N=>{let a=N.target.classList.contains("bg-white-black")?d(y[0],b[0]):d(y[1],b[1]);i.setAttribute("content",a)}),p=new IntersectionObserver(c,{rootMargin:"0% 0% -95% 0%"});document.querySelectorAll("section").forEach($=>p.observe($))},change:()=>d()?T():M(),isDarkMode:d,isAutoMode:()=>r}})();var oe=(()=>{let m=null,b=!0,y=["input[data-offline-disabled]","button[data-offline-disabled]","select[data-offline-disabled]","textarea[data-offline-disabled]"],r=()=>b,h=()=>{let d=m.firstElementChild.firstElementChild;d.classList.remove("bg-success"),d.classList.add("bg-danger"),d.firstElementChild.innerHTML='<i class="fa-solid fa-ban me-2"></i>Koneksi tidak tersedia'},i=()=>{let d=m.firstElementChild.firstElementChild;d.classList.remove("bg-danger"),d.classList.add("bg-success"),d.firstElementChild.innerHTML='<i class="fa-solid fa-cloud me-2"></i>Koneksi tersedia kembali'},l=async()=>{b&&(await w.changeOpacity(m,!1),h())},u=()=>{document.querySelectorAll(y.join(", ")).forEach(d=>{d.dispatchEvent(new Event(r()?"online":"offline")),d.setAttribute("data-offline-disabled",r()?"false":"true"),d.tagName==="BUTTON"?r()?d.classList.remove("disabled"):d.classList.add("disabled"):r()?d.removeAttribute("disabled"):d.setAttribute("disabled","true")})},I=()=>{b=!1,h(),w.changeOpacity(m,!0),u()},T=()=>{b=!0,i(),w.timeOut(l,3e3),u()};return{init:()=>{window.addEventListener("online",T),window.addEventListener("offline",I),m=document.getElementById("offline-mode"),m.innerHTML=`
        <div class="d-flex justify-content-center mx-auto">
            <div class="d-flex justify-content-center align-items-center rounded-pill my-2 bg-danger shadow">
                <small class="text-center py-1 px-2 mx-1 mt-1 mb-0 text-white" style="font-size: 0.8rem;"></small>
            </div>
        </div>`},isOnline:r}})();var D=(()=>{let m="gifs",b="default",y={128:2,256:3,512:4,768:5},r={id:"ID",en:"US",fr:"FR",de:"DE",es:"ES",zh:"CN",ja:"JP",ko:"KR",ar:"SA",ru:"RU",it:"IT",nl:"NL",pt:"PT",tr:"TR",th:"TH",vi:"VN",ms:"MY",hi:"IN"},h=null,i=null,l=null,u=null,I=async e=>{if(h.has(e))return h.get(e);let s=(E,R=3,H=1e3)=>_(z,e).default().then(P=>P.blob().then(U=>E.put(e,new Response(U,{headers:new Headers(P.headers)})).then(()=>U))).catch(P=>{if(R<=0)throw P;return console.warn("Retrying fetch:"+e),new Promise(U=>w.timeOut(()=>U(s(E,R-1,H+1e3)),H))}),v=E=>E.match(e).then(R=>{if(!R)return s(E);let H=R.headers.get("expires"),P=H?new Date(H).getTime():0;return Date.now()>P?E.delete(e).then(U=>U?s(E):R.blob()):R.blob()});return await caches.open(m).then(E=>v(E)).then(E=>URL.createObjectURL(E)).then(E=>(h.set(e,E),E))},T=async(e,s)=>{let{id:v,media_formats:{tinygif:{url:A}},content_description:E}=s;e.pointer===-1||e.pointer===e.col-1?e.pointer=0:e.pointer++;let R=0;for(let H of e.lists.childNodes)R===e.pointer&&await I(A).then(P=>{H.insertAdjacentHTML("beforeend",`
                    <figure class="gif-figure m-0 position-relative">
                        <div onclick="undangan.comment.gif.click('${e.uuid}', '${v}', '${w.base64Encode(A)}')" class="gif-checklist position-absolute justify-content-center align-items-center top-0 end-0 bg-overlay-auto p-1 m-1 rounded-circle border shadow-sm z-1">
                            <i class="fa-solid fa-circle-check"></i>
                        </div>
                        <img src="${P}" class="img-fluid" alt="${w.escapeHtml(E)}" style="width: 100%;">
                    </figure>
                `)}),R++},M=e=>{let s=e.lists,v=document.getElementById(`gif-loading-${e.uuid}`);return s.classList.contains("d-none")||v.classList.replace("d-none","d-flex"),s.setAttribute("data-continue","false"),s.classList.replace("overflow-y-scroll","overflow-y-hidden"),{release:()=>{s.classList.contains("d-none")||v.classList.replace("d-flex","d-none"),s.setAttribute("data-continue","true"),s.classList.replace("overflow-y-hidden","overflow-y-scroll")}}},d=(e,s,v)=>{let A=!0;e.last=new Promise(E=>{let R=M(e);(async()=>(await s,A=!1))(),(async()=>{try{let H=await v;e.next=H?.next;for(let P of H.results)A&&(e.gifs.push(P),await T(e,P))}catch(H){H.name==="AbortError"?console.warn("Fetch abort:",H):alert(H)}finally{R.release(),E()}})()})},g=(e,s)=>{s={key:u.get("tenor_key"),media_filter:"tinygif",client_key:"undangan_app",country:u.get("country"),locale:u.get("locale"),...s??{}};let v=Object.keys(s).filter(E=>s[E]!==null&&s[E]!==void 0).filter(E=>typeof s[E]!="object").map(E=>`${E}=${encodeURIComponent(s[E])}`).join("&"),A=_(z,`https://tenor.googleapis.com/v2${e}?${v}`);return s.reqCancel&&(A=A.withCancel(s.reqCancel)),A.default().then(E=>E.json()).then(E=>{if(!E.error)return E;throw new Error(E.error.message)})},k=async e=>{if(!e.next||e.next.length===0)return;let s=e.query&&e.query.trim().length,v={pos:e.next,limit:e.limit};s&&(v.q=e.query),e.last&&(await e.last,e.last=null),v.reqCancel=new Promise(E=>{e.reqs.push(E)});let A=(e.lists.scrollHeight-e.lists.clientHeight)*.9;e.lists.scrollTop>A&&e.lists.getAttribute("data-continue")==="true"&&d(e,v.reqCancel,g(s?"/search":"/featured",v))},B=e=>`
        <label for="gif-search-${e}" class="form-label my-1"><i class="fa-solid fa-photo-film me-2"></i>Gif</label>

        <div class="d-flex mb-3" id="gif-search-nav-${e}">
            <button class="btn btn-secondary btn-sm rounded-4 shadow-sm me-1 my-1" onclick="undangan.comment.gif.back('${e}')" data-offline-disabled="false"><i class="fa-solid fa-arrow-left"></i></button>
            <input type="text" name="gif-search" id="gif-search-${e}" autocomplete="off" class="form-control shadow-sm rounded-4" placeholder="Cari GIF oleh Tenor" data-offline-disabled="false">
        </div>

        <div class="position-relative">
            <div class="position-absolute d-flex justify-content-center align-items-center top-50 start-50 translate-middle w-100 h-100 bg-overlay-auto rounded-4 z-3" id="gif-loading-${e}">
                <div class="spinner-border" role="status"></div>
            </div>
            <div id="gif-lists-${e}" class="d-flex rounded-4 p-0 overflow-y-scroll border" data-continue="true" style="height: 15rem;"></div>
        </div>

        <figure class="d-flex m-0 position-relative" id="gif-result-${e}">
            <div onclick="undangan.comment.gif.cancel('${e}')" id="gif-cancel-${e}" class="d-none position-absolute justify-content-center align-items-center top-0 end-0 bg-overlay-auto p-2 m-1 rounded-circle border shadow-sm z-1" style="cursor: pointer;">
                <i class="fa-solid fa-circle-xmark"></i>
            </div>
        </figure>`,q=async e=>{let s=0;for(let[A,E]of Object.entries(y))s=E,e.lists.clientWidth>=parseInt(A)&&(e.col=s);if(e.col===null&&(e.col=s),e.pointer=-1,e.limit=e.col*5,e.lists.innerHTML='<div class="d-flex flex-column"></div>'.repeat(e.col),e.gifs.length===0)return;let v=M(e);for(let A of e.gifs)await T(e,A);v.release()},c=async(e,s)=>{e.query=s.value,(!e.query||e.query.trim().length===0)&&(e.query=null),e.reqs.forEach(A=>A()),e.reqs=[],e.last&&(await e.last,e.last=null);let v=new Promise(A=>{e.reqs.push(A)});e.next=null,e.gifs=[],e.pointer=-1,await q(e),d(e,v,g(e.query===null?"/featured":"/search",{q:e.query,limit:e.limit,reqCancel:v}))},p=e=>{if(!i.has(e)){let s=document.getElementById(`gif-form-${e}`);s.innerHTML=B(e);let v=w.debounce(q,500),A=w.debounce(c,500);i.set(e,{uuid:e,last:null,limit:null,query:null,next:null,col:null,pointer:-1,gifs:[],reqs:[],container:s,lists:document.getElementById(`gif-lists-${e}`)});let E=i.get(e);E.lists.addEventListener("scroll",()=>k(E)),window.addEventListener("resize",()=>v(E)),document.getElementById(`gif-search-${e}`).addEventListener("input",R=>A(E,R.target))}return i.get(e)};return{default:b,init:()=>{h=new Map,l=new Map,i=new Map,u=C("config");let e=document.documentElement.lang.toLowerCase();u.set("country",r[e]??"US"),u.set("locale",`${e}_${u.get("country")}`),u.get("tenor_key")===null&&document.querySelector('[onclick="undangan.comment.gif.open(undangan.comment.gif.default)"]')?.remove()},cache:I,back:e=>{p(e).container.classList.toggle("d-none",!0),document.getElementById(`comment-form-${e}`)?.classList.toggle("d-none",!1)},open:async e=>{let s=p(e);s.container.classList.toggle("d-none",!1),document.getElementById(`comment-form-${e}`)?.classList.toggle("d-none",!0),l.has(e)&&l.get(e)(),s.reqs.forEach(A=>A()),s.reqs=[],s.last&&(await s.last,s.last=null);let v=new Promise(A=>{s.reqs.push(A)});await q(s),d(s,v,g("/featured",{limit:s.limit,reqCancel:v}))},cancel:e=>{let s=document.getElementById(`gif-result-${e}`);s.removeAttribute("data-id"),s.querySelector(`#gif-cancel-${e}`).classList.replace("d-flex","d-none"),s.querySelector("img").remove(),p(e).lists.classList.replace("d-none","d-flex"),document.getElementById(`gif-search-nav-${e}`).classList.replace("d-none","d-flex")},click:(e,s,v)=>{let A=document.getElementById(`gif-result-${e}`);A.setAttribute("data-id",s),A.querySelector(`#gif-cancel-${e}`).classList.replace("d-none","d-flex"),A.insertAdjacentHTML("beforeend",`<img src="${h.get(w.base64Decode(v))}" class="img-fluid mx-auto gif-image rounded-4" alt="selected-gif">`),p(e).lists.classList.replace("d-flex","d-none"),document.getElementById(`gif-search-nav-${e}`).classList.replace("d-flex","d-none")},remove:(e=null)=>{e?i.has(e)&&(i.get(e).reqs.forEach(s=>s()),i.delete(e),l.delete(e)):(i.forEach(s=>s.reqs.forEach(v=>v())),i.clear(),l.clear())},isOpen:e=>{if(!i.has(e))return!1;let s=i.get(e);return s.container===null?!1:!s.container.classList.contains("d-none")},onOpen:(e,s)=>l.set(e,s),getResultId:e=>document.getElementById(`gif-result-${e}`)?.getAttribute("data-id")}})();var j=(()=>{let m=null,b=null,y=null,r=null,h=null,i=null,l=250,u=[["*",'<strong class="text-theme-auto">$1</strong>'],["_",'<em class="text-theme-auto">$1</em>'],["~",'<del class="text-theme-auto">$1</del>'],["```",'<code class="font-monospace text-theme-auto">$1</code>']],I=()=>`
        <div class="bg-theme-auto shadow p-3 mx-0 mt-0 mb-3 rounded-4">
            <div class="d-flex justify-content-between align-items-center placeholder-wave">
                <span class="placeholder bg-secondary col-5 rounded-3 my-1"></span>
                <span class="placeholder bg-secondary col-3 rounded-3 my-1"></span>
            </div>
            <hr class="my-1">
            <p class="placeholder-wave m-0">
                <span class="placeholder bg-secondary col-6 rounded-3"></span>
                <span class="placeholder bg-secondary col-5 rounded-3"></span>
                <span class="placeholder bg-secondary col-12 rounded-3 my-1"></span>
            </p>
        </div>`,T=t=>(u.forEach(o=>{let f=o[0],L=o[1];t=t.replace(new RegExp(`\\${f}(?=\\S)(.*?)(?<!\\s)\\${f}`,"gs"),L)}),t),M=t=>`
        <button style="font-size: 0.8rem;" onclick="undangan.comment.like.love(this)" data-uuid="${t.uuid}" class="btn btn-sm btn-outline-auto ms-auto rounded-3 p-0 shadow-sm d-flex justify-content-start align-items-center" data-offline-disabled="false">
            <span class="my-0 mx-1" data-count-like="${t.like.love}">${t.like.love}</span>
            <i class="me-1 ${y.has(t.uuid)?"fa-solid fa-heart text-danger":"fa-regular fa-heart"}"></i>
        </button>`,d=t=>{let o=t.gif_url!==null&&t.gif_url!==void 0,f=`<div class="d-flex justify-content-start align-items-center" data-button-action="${t.uuid}">`;return(r.get("can_reply")===!0||r.get("can_reply")===void 0)&&(f+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.reply(this)" data-uuid="${t.uuid}" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1 shadow-sm" data-offline-disabled="false">Reply</button>`),b.has(t.uuid)&&(r.get("can_edit")===!0||r.get("can_edit")===void 0)&&!(o&&r.get("tenor_key")===null)&&(f+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.edit(this)" data-uuid="${t.uuid}" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1 shadow-sm" data-offline-disabled="false">Edit</button>`),x.isAdmin()?f+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.remove(this)" data-uuid="${t.uuid}" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1 shadow-sm" data-own="${t.own}" data-offline-disabled="false">Delete</button>`:b.has(t.uuid)&&(r.get("can_delete")===!0||r.get("can_delete")===void 0)&&(f+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.remove(this)" data-uuid="${t.uuid}" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1 shadow-sm" data-offline-disabled="false">Delete</button>`),f+="</div>",f},g=(t,o)=>{let f=i.get("show").includes(t);return`<a class="text-theme-auto" style="font-size: 0.8rem;" onclick="undangan.comment.showOrHide(this)" data-uuid="${t}" data-uuids="${o.join(",")}" data-show="${f?"true":"false"}" role="button" class="me-auto ms-1 py-0">${f?"Hide replies":`Show replies (${o.length})`}</a>`},k=t=>`
        <div class="d-flex justify-content-between align-items-center" id="button-${t.uuid}">
            ${d(t)}
            ${t.comments.length>0?g(t.uuid,t.comments.map(o=>o.uuid)):""}
            ${M(t)}
        </div>`,B=t=>t.ip===void 0||t.user_agent===void 0||t.is_admin?"":`
        <div class="mb-1 mt-3">
            <p class="text-theme-auto mb-1 mx-0 mt-0 p-0" style="font-size: 0.7rem;" id="ip-${t.uuid}"><i class="fa-solid fa-location-dot me-1"></i>${w.escapeHtml(t.ip)} ${h.has(t.ip)?`<strong>${h.get(t.ip)}</strong>`:'<span class="mb-1 placeholder col-2 rounded-3"></span>'}</p>
            <p class="text-theme-auto m-0 p-0" style="font-size: 0.7rem;"><i class="fa-solid fa-mobile-screen-button me-1"></i>${w.parseUserAgent(w.escapeHtml(t.user_agent))}</p>
        </div>`,q=(t,o)=>o?'class="bg-theme-auto shadow p-3 mx-0 mt-0 mb-3 rounded-4" data-parent="true"':`class="${i.get("hidden").find(f=>f.uuid===t.uuid).show?"":"d-none"} overflow-x-scroll mw-100 border-start bg-theme-auto py-2 ps-2 pe-0 my-2 ms-2 me-0"`,c=(t,o)=>t.is_admin?`<strong class="me-1">${w.escapeHtml(m.get("name")??r.get("name"))}</strong><i class="fa-solid fa-certificate text-primary"></i>`:o?`<strong class="me-1">${w.escapeHtml(t.name)}</strong><i id="badge-${t.uuid}" class="fa-solid ${t.presence?"fa-circle-check text-success":"fa-circle-xmark text-danger"}"></i>`:`<strong>${w.escapeHtml(t.name)}</strong>`,p=async(t,o)=>{let f=T(w.escapeHtml(t.comment)),L=f.length>l,S=t.gif_url!==null&&t.gif_url!==void 0,e=`
        <div class="d-flex justify-content-between align-items-center">
            <p class="text-theme-auto text-truncate m-0 p-0" style="font-size: 0.95rem;">${c(t,o)}</p>
            <small class="text-theme-auto m-0 p-0" style="font-size: 0.75rem;">${t.created_at}</small>
        </div>
        <hr class="my-1">
        `;if(S){let s=await D.cache(t.gif_url);return e+`
            <div class="d-flex justify-content-center align-items-center my-2">
                <img src="${s}" id="img-gif-${t.uuid}" class="img-fluid mx-auto gif-image rounded-4" alt="selected-gif">
            </div>
            `}return e+`
        <p class="text-theme-auto my-1 mx-0 p-0" style="white-space: pre-wrap !important; font-size: 0.95rem;" ${L?`data-comment="${w.base64Encode(f)}"`:""} id="content-${t.uuid}">${L?f.slice(0,l)+"...":f}</p>
        ${L?`<p class="d-block mb-2 mt-0 mx-0 p-0"><a class="text-theme-auto" role="button" style="font-size: 0.85rem; display: block;" data-show="false" onclick="undangan.comment.showMore(this, '${t.uuid}')">Selengkapnya</a></p>`:""}`},$=async(t,o)=>{let f=await p(t,o),L="";for(let S of t.comments)L+=await $(S,!1);return`
        <div ${q(t,o)} id="${t.uuid}" style="overflow-wrap: break-word !important;">
            <div id="body-content-${t.uuid}" data-tapTime="0" data-liked="false" tabindex="0">
                ${f}
            </div>
            ${B(t)}
            ${k(t)}
            <div id="reply-content-${t.uuid}">${L}</div>
        </div>`};return{init:()=>{m=C("user"),b=C("owns"),y=C("likes"),r=C("config"),h=C("tracker"),i=C("comment")},renderEdit:(t,o,f,L)=>{let S=document.createElement("div");return S.classList.add("my-2"),S.id=`inner-${t}`,S.innerHTML=`
        <p class="my-1 mx-0 p-0" style="font-size: 0.95rem;"><i class="fa-solid fa-pen me-2"></i>Edit</p>
        ${f?`
        <select class="form-select shadow-sm mb-2 rounded-4" id="form-inner-presence-${t}" data-offline-disabled="false">
            <option value="1" ${o?"selected":""}>Datang</option>
            <option value="2" ${o?"":"selected"}>Berhalangan</option>
        </select>`:""}
        ${L?`${r.get("tenor_key")===null?"":`<div class="d-none mb-2" id="gif-form-${t}"></div>`}`:`<textarea class="form-control shadow-sm rounded-4 mb-2" id="form-inner-${t}" minlength="1" maxlength="1000" placeholder="Type update comment" rows="3" data-offline-disabled="false"></textarea>    
        `}
        <div class="d-flex justify-content-end align-items-center mb-0">
            <button style="font-size: 0.8rem;" onclick="undangan.comment.cancel('${t}')" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1" data-offline-disabled="false">Cancel</button>
            <button style="font-size: 0.8rem;" onclick="undangan.comment.update(this)" data-uuid="${t}" class="btn btn-sm btn-outline-auto rounded-4 py-0" data-offline-disabled="false">Update</button>
        </div>`,S},renderReply:t=>{let o=document.createElement("div");return o.classList.add("my-2"),o.id=`inner-${t}`,o.innerHTML=`
        <p class="my-1 mx-0 p-0" style="font-size: 0.95rem;"><i class="fa-solid fa-reply me-2"></i>Reply</p>
        <div class="d-block mb-2" id="comment-form-${t}">
            <div class="position-relative">
                ${r.get("tenor_key")===null?"":`<button class="btn btn-secondary btn-sm rounded-4 shadow-sm me-1 my-1 position-absolute bottom-0 end-0" onclick="undangan.comment.gif.open('${t}')" aria-label="button gif" data-offline-disabled="false"><i class="fa-solid fa-photo-film"></i></button>`}
                <textarea class="form-control shadow-sm rounded-4 mb-2" id="form-inner-${t}" minlength="1" maxlength="1000" placeholder="Type reply comment" rows="3" data-offline-disabled="false"></textarea>
            </div>
        </div>
        <div class="d-none mb-2" id="gif-form-${t}"></div>
        <div class="d-flex justify-content-end align-items-center mb-0">
            <button style="font-size: 0.8rem;" onclick="undangan.comment.cancel('${t}')" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1" data-offline-disabled="false">Cancel</button>
            <button style="font-size: 0.8rem;" onclick="undangan.comment.send(this)" data-uuid="${t}" class="btn btn-sm btn-outline-auto rounded-4 py-0" data-offline-disabled="false">Send</button>
        </div>`,o},renderLoading:I,renderReadMore:g,renderInnerContent:t=>$(t,!1),renderContent:t=>$(t,!0),convertMarkdownToHTML:T,maxCommentLength:l}})();var le=()=>window.confetti.shapeFromPath({path:"M167 72c19,-38 37,-56 75,-56 42,0 76,33 76,75 0,76 -76,151 -151,227 -76,-76 -151,-151 -151,-227 0,-42 33,-75 75,-75 38,0 57,18 76,56z",matrix:[.03333333333333333,0,0,.03333333333333333,-5.566666666666666,-5.533333333333333]});var se=m=>{if(!window.confetti)return;let b=Date.now()+25,y=Math.max(.3,Math.min(1,m.getBoundingClientRect().top/window.innerHeight+.2)),r=le(),h=["#FF69B4","#FF1493"];(function i(){h.forEach(l=>{window.confetti({particleCount:2,angle:60,spread:55,shapes:[r],origin:{x:0,y},zIndex:1057,colors:[l]}),window.confetti({particleCount:2,angle:120,spread:55,shapes:[r],origin:{x:1,y},zIndex:1057,colors:[l]})}),Date.now()<b&&requestAnimationFrame(i)})()};var Z=(()=>{let m=null,b=async h=>{let i=h.firstElementChild,l=h.lastElementChild,u=h.getAttribute("data-uuid"),I=parseInt(i.getAttribute("data-count-like"));h.disabled=!0,m.has(u)?await _(G,"/api/comment/"+m.get(u)).token(x.getToken()).send(O.statusResponse).then(T=>{T.data.status&&(m.unset(u),l.classList.remove("fa-solid","text-danger"),l.classList.add("fa-regular"),i.setAttribute("data-count-like",String(I-1)))}):await _(K,"/api/comment/"+u).token(x.getToken()).send(O.uuidResponse).then(T=>{T.code===Y&&(m.set(u,T.data.uuid),l.classList.remove("fa-regular"),l.classList.add("fa-solid","text-danger"),i.setAttribute("data-count-like",String(I+1)))}),i.innerText=i.getAttribute("data-count-like"),h.disabled=!1};return{init:()=>{m=C("likes")},love:b,tapTap:async h=>{if(!navigator.onLine)return;let i=Date.now(),l=i-parseInt(h.getAttribute("data-tapTime")),u=h.id.replace("body-content-",""),I=l<300&&l>0,T=!m.has(u)&&h.getAttribute("data-liked")!=="true";if(I&&T){navigator.vibrate&&navigator.vibrate(100),se(h);let M=document.querySelector(`[onclick="undangan.comment.like.love(this)"][data-uuid="${u}"]`);h.setAttribute("data-liked","true"),await b(M),h.setAttribute("data-liked","false")}h.setAttribute("data-tapTime",i)}}})();var F=(()=>{let m=10,b=0,y=0,r=null,h=null,i=null,l=null,u=null,I=o=>{m=Number(o)},T=()=>m,M=()=>b,d=()=>y,g=()=>h.classList.contains("disabled")?null:h.classList.add("disabled"),k=()=>h.classList.contains("disabled")?h.classList.remove("disabled"):null,B=()=>i.classList.contains("disabled")?null:i.classList.add("disabled"),q=()=>i.classList.contains("disabled")?i.classList.remove("disabled"):null,c=()=>{l.classList.contains("d-none")&&l.classList.remove("d-none")},p=o=>{o.disabled=!0;let f=o.innerHTML;o.innerHTML=w.loader.replace("ms-0 me-1","mx-1");let L=async()=>{let s=new Promise(v=>u.addEventListener("comment.result",v));u.dispatchEvent(new Event("comment.show")),await s,o.disabled=!1,o.innerHTML=f,u.scrollIntoView({behavior:"smooth"})};return{next:async()=>{b+=m,o.innerHTML="Next"+o.innerHTML,await L(),r.innerText=String(parseInt(r.innerText)+1)},prev:async()=>{b-=m,o.innerHTML=o.innerHTML+"Prev",await L(),r.innerText=String(parseInt(r.innerText)-1)}}};return{init:()=>{l=document.getElementById("pagination"),l.innerHTML=`
        <ul class="pagination mb-2 shadow-sm rounded-4">
            <li class="page-item disabled" id="previous">
                <button class="page-link rounded-start-4" onclick="undangan.comment.pagination.previous(this)" data-offline-disabled="false">
                    <i class="fa-solid fa-circle-left me-1"></i>Prev
                </button>
            </li>
            <li class="page-item disabled">
                <span class="page-link text-theme-auto" id="page">1</span>
            </li>
            <li class="page-item" id="next">
                <button class="page-link rounded-end-4" onclick="undangan.comment.pagination.next(this)" data-offline-disabled="false">
                    Next<i class="fa-solid fa-circle-right ms-1"></i>
                </button>
            </li>
        </ul>`,u=document.getElementById("comments"),r=document.getElementById("page"),h=document.getElementById("previous"),i=document.getElementById("next")},setPer:I,getPer:T,getNext:M,reset:()=>b===0?!1:(b=0,y=0,r.innerText=1,B(),g(),!0),setResultData:o=>{if(y=o,b>0&&k(),y<m){B();return}q(),c()},getResultData:d,previous:async o=>{g(),!(b<0)&&(B(),await p(o).prev())},next:async o=>{B(),!(y<m)&&(g(),await p(o).next())}}})();var ee=(()=>{let m=null,b=null,y=null,r=null,h=[],i=()=>'<div class="text-center p-4 my-2 bg-theme-auto rounded-4 shadow"><p class="fw-bold p-0 m-0" style="font-size: 0.95rem;">Yuk bagikan undangan ini biar banyak komentarnya</p></div>',l=(a,n)=>{document.querySelector(`[data-button-action="${a}"]`).childNodes.forEach(t=>{t.disabled=n})},u=a=>{a.comments&&a.comments.forEach(u);let n=document.getElementById(`body-content-${a.uuid}`);n.addEventListener("touchend",()=>Z.tapTap(n))},I=a=>{if(!x.isAdmin()||(a.comments&&a.comments.forEach(I),a.ip===void 0||a.user_agent===void 0||a.is_admin||y.has(a.ip)))return;let n=(t,o,f)=>{document.getElementById(`ip-${t}`).innerHTML=`<i class="fa-solid fa-location-dot me-1"></i>${w.escapeHtml(o)} <strong>${w.escapeHtml(f)}</strong>`};_(z,`https://freeipapi.com/api/json/${a.ip}`).default().then(t=>t.json()).then(t=>{let o=t.cityName+" - "+t.regionName;t.cityName==="-"&&t.regionName==="-"&&(o="localhost"),y.set(a.ip,o),n(a.uuid,a.ip,o)}).catch(t=>n(a.uuid,a.ip,t.message))},T=(a,n=[])=>(a.forEach(t=>{n.find(o=>o.uuid===t.uuid)||n.push(O.commentShowMore(t.uuid)),t.comments&&t.comments.length>0&&T(t.comments,n)}),n),M=()=>{let a=document.getElementById("comments");return a.getAttribute("data-loading")==="false"&&(a.setAttribute("data-loading","true"),a.innerHTML=j.renderLoading().repeat(F.getPer())),_(z,`/api/comment?per=${F.getPer()}&next=${F.getNext()}`).token(x.getToken()).send(O.getCommentsResponse).then(async n=>{let t=n.data.length;if(a.setAttribute("data-loading","false"),h.map(f=>f.uuid).forEach(f=>D.remove(f)),t===0)return F.setResultData(t),a.innerHTML=i(),n;h=T(n.data),r.set("hidden",T(n.data,r.get("hidden")));let o="";for(let f of n.data)o+=await j.renderContent(f);return a.innerHTML=o,n.data.forEach(I),n.data.forEach(u),F.setResultData(t),a.dispatchEvent(new Event("comment.result")),n})},d=a=>{let n=a.getAttribute("data-uuids").split(","),t=a.getAttribute("data-show")==="true",o=a.getAttribute("data-uuid");t?(a.setAttribute("data-show","false"),a.innerText=`Show replies (${n.length})`,r.set("show",r.get("show").filter(f=>f!==o))):(a.setAttribute("data-show","true"),a.innerText="Hide replies",r.set("show",r.get("show").concat([o])));for(let f of n){r.set("hidden",r.get("hidden").map(S=>(S.uuid===f&&(S.show=!t),S)));let L=document.getElementById(f).classList;t?L.add("d-none"):L.remove("d-none")}};return{gif:D,like:Z,pagination:F,init:()=>{D.init(),Z.init(),j.init(),F.init(),document.getElementById("comments").addEventListener("comment.show",M),m=C("owns"),b=C("user"),y=C("tracker"),r=C("comment"),r.has("hidden")||r.set("hidden",[]),r.has("show")||r.set("show",[])},send:async a=>{let n=a.getAttribute("data-uuid"),t=document.getElementById("form-name"),o=t.value;if(x.isAdmin()&&(o=b.get("name")),o.length===0){alert("Name cannot be empty."),n&&document.getElementById("comment").scrollIntoView({behavior:"smooth"});return}let f=document.getElementById("form-presence");if(!n&&f&&f.value==="0"){alert("Please select your attendance status.");return}let L=D.isOpen(n||"default"),S=D.getResultId(n||"default"),e=document.getElementById(`gif-cancel-${n||"default"}`);if(L&&!S){alert("Gif cannot be empty.");return}L&&S&&e.classList.replace("d-flex","d-none");let s=document.getElementById(`form-${n?`inner-${n}`:"comment"}`);if(!L&&s.value.length===0){alert("Comments cannot be empty.");return}!n&&t&&!x.isAdmin()&&(t.disabled=!0),!x.isAdmin()&&f&&f.value!=="0"&&(f.disabled=!0),s&&(s.disabled=!0);let v=document.querySelector(`[onclick="undangan.comment.cancel('${n}')"]`);v&&(v.disabled=!0);let A=w.disableButton(a),E=f?f.value==="1":!0;if(!x.isAdmin()){let H=C("information");H.set("name",o),n||H.set("presence",E)}let R=await _(K,"/api/comment").token(x.getToken()).body(O.postCommentRequest(n,o,E,D.isOpen(n)?null:s.value,S)).send(O.getCommentResponse).then(H=>H,()=>null);if(t&&(t.disabled=!1),s&&(s.disabled=!1),v&&(v.disabled=!1),f&&(f.disabled=!1),L&&S&&e.classList.replace("d-none","d-flex"),A.restore(),!(!R||R.code!==Y)){if(m.set(R.data.uuid,R.data.own),s&&(s.value=null),L&&S&&e.dispatchEvent(new Event("click")),!n){let H=document.getElementById("comments");if(F.reset()){await M(),H.scrollIntoView({behavior:"smooth"});return}F.setResultData(H.children.length),F.getResultData()===F.getPer()&&H.lastElementChild.remove(),R.data.is_admin=x.isAdmin();let P=await j.renderContent(R.data);H.insertAdjacentHTML("afterbegin",P),H.scrollIntoView({behavior:"smooth"})}if(n){r.set("hidden",r.get("hidden").concat([O.commentShowMore(R.data.uuid,!0)])),r.set("show",r.get("show").concat([n])),l(n,!1),document.getElementById(`inner-${n}`).remove(),R.data.is_admin=x.isAdmin(),document.getElementById(`reply-content-${n}`).insertAdjacentHTML("beforeend",await j.renderInnerContent(R.data));let H=document.getElementById(`button-${n}`),P=H.querySelector("a"),U=[R.data.uuid];P&&(P.getAttribute("data-show")==="false"&&d(P),P.remove());let ie=`button[onclick="undangan.comment.like.love(this)"][data-uuid="${n}"]`;H.querySelector(ie).insertAdjacentHTML("beforebegin",j.renderReadMore(n,P?P.getAttribute("data-uuids").split(",").concat(U):U))}u(R.data)}},edit:async a=>{let n=a.getAttribute("data-uuid");if(document.getElementById(`inner-${n}`))return;l(n,!0);let t=w.disableButton(a);await _(z,"/api/comment/"+n).token(x.getToken()).send(O.commentResponse).then(o=>{if(o.code!==V)return o;let f=o.data.gif_url!==null&&o.data.gif_url!==void 0;f&&D.remove(n);let L=document.getElementById(n).getAttribute("data-parent")==="true"&&!x.isAdmin();if(document.getElementById(`button-${n}`).insertAdjacentElement("afterend",j.renderEdit(n,o.data.presence,L,f)),f)return D.onOpen(n,()=>{document.querySelector(`[for="gif-search-${n}"]`)?.remove(),document.querySelector(`[onclick="undangan.comment.gif.back('${n}')"]`)?.remove()}),D.open(n);let S=document.getElementById(`form-inner-${n}`);return S.value=o.data.comment,S.setAttribute("data-original",w.base64Encode(o.data.comment)),o}),t.restore(),a.disabled=!0},reply:a=>{let n=a.getAttribute("data-uuid");document.getElementById(`inner-${n}`)||(D.remove(n),l(n,!0),document.getElementById(`button-${n}`).insertAdjacentElement("afterend",j.renderReply(n)),D.onOpen(n,()=>document.querySelector(`[for="gif-search-${n}"]`)?.remove()))},remove:async a=>{if(!confirm("Are you sure?"))return;let n=a.getAttribute("data-uuid");x.isAdmin()&&m.set(n,a.getAttribute("data-own")),l(n,!0);let t=w.disableButton(a),o=document.querySelector(`[onclick="undangan.comment.like.love(this)"][data-uuid="${n}"]`);if(o.disabled=!0,!await _(te,"/api/comment/"+m.get(n)).token(x.getToken()).send(O.statusResponse).then(S=>S.data.status,()=>!1)){t.restore(),o.disabled=!1;return}document.querySelectorAll('a[onclick="undangan.comment.showOrHide(this)"]').forEach(S=>{let e=S.getAttribute("data-uuids").split(",");if(e.find(s=>s===n)){let s=e.filter(v=>v!==n).join(",");s.length===0?S.remove():S.setAttribute("data-uuids",s)}}),m.unset(n),document.getElementById(n).remove();let L=document.getElementById("comments");L.children.length===0&&(L.innerHTML=i())},update:async a=>{let n=a.getAttribute("data-uuid"),t=!1,o=document.getElementById(`form-inner-presence-${n}`);o&&(o.disabled=!0,t=o.value==="1");let f=!1,L=document.getElementById(`badge-${n}`);L&&(f=L.classList.contains("text-success"));let S=D.isOpen(n),e=D.getResultId(n),s=document.getElementById(`gif-cancel-${n}`),v=document.getElementById(`form-inner-${n}`);if(S&&e&&s.classList.replace("d-flex","d-none"),n&&!S&&w.base64Encode(v.value)===v.getAttribute("data-original")&&f===t){l(n,!1),document.getElementById(`inner-${n}`).remove();return}v&&(v.disabled=!0);let A=document.querySelector(`[onclick="undangan.comment.cancel('${n}')"]`);A&&(A.disabled=!0);let E=w.disableButton(a),R=await _(X,"/api/comment/"+m.get(n)).token(x.getToken()).body(O.updateCommentRequest(o?t:null,D.isOpen(n)?null:v.value,e)).send(O.statusResponse).then(H=>H.data.status,()=>!1);if(v&&(v.disabled=!1),A&&(A.disabled=!1),o&&(o.disabled=!1),E.restore(),S&&e&&s.classList.replace("d-none","d-flex"),!!R){if(S&&e&&(document.getElementById(`img-gif-${n}`).src=document.getElementById(`gif-result-${n}`)?.querySelector("img").src,s.dispatchEvent(new Event("click"))),l(n,!1),document.getElementById(`inner-${n}`).remove(),!S){let H=document.querySelector(`[onclick="undangan.comment.showMore(this, '${n}')"]`),P=j.convertMarkdownToHTML(w.escapeHtml(v.value)),U=document.getElementById(`content-${n}`);P.length>j.maxCommentLength?(U.innerHTML=H?.getAttribute("data-show")==="false"?P.slice(0,j.maxCommentLength)+"...":P,U.setAttribute("data-comment",w.base64Encode(P)),H?.classList.replace("d-none","d-block")):(U.innerHTML=P,U.removeAttribute("data-comment"),H?.classList.replace("d-block","d-none"))}if(o&&(document.getElementById("form-presence").value=t?"1":"2",C("information").set("presence",t)),!(!o||!L)){if(t){L.classList.remove("fa-circle-xmark","text-danger"),L.classList.add("fa-circle-check","text-success");return}L.classList.remove("fa-circle-check","text-success"),L.classList.add("fa-circle-xmark","text-danger")}}},cancel:a=>{let n=document.getElementById(`form-inner-presence-${a}`),t=n?n.value==="1":!1,o=document.getElementById(`badge-${a}`),f=o?o.classList.contains("text-success"):!1;if(D.isOpen(a)){(!D.getResultId(a)&&f===t||confirm("Are you sure?"))&&(D.remove(a),l(a,!1),document.getElementById(`inner-${a}`).remove());return}let L=document.getElementById(`form-inner-${a}`);(L.value.length===0||w.base64Encode(L.value)===L.getAttribute("data-original")&&f===t||confirm("Are you sure?"))&&(l(a,!1),document.getElementById(`inner-${a}`).remove())},show:M,showMore:(a,n)=>{let t=document.getElementById(`content-${n}`),o=w.base64Decode(t.getAttribute("data-comment")),f=a.getAttribute("data-show")==="false";t.innerHTML=f?o:o.slice(0,j.maxCommentLength)+"...",a.innerText=f?"Sebagian":"Selengkapnya",a.setAttribute("data-show",f?"true":"false")},showOrHide:d}})();var ae=(()=>{let m=()=>J.getDetailUser().then(c=>{document.getElementById("dashboard-name").innerHTML=`${w.escapeHtml(c.data.name)}<i class="fa-solid fa-hands text-warning ms-2"></i>`,document.getElementById("dashboard-email").innerHTML=c.data.email,document.getElementById("dashboard-accesskey").value=c.data.access_key,document.getElementById("button-copy-accesskey").setAttribute("data-copy",c.data.access_key),document.getElementById("form-name").value=w.escapeHtml(c.data.name),document.getElementById("filterBadWord").checked=!!c.data.is_filter,document.getElementById("replyComment").checked=!!c.data.can_reply,document.getElementById("editComment").checked=!!c.data.can_edit,document.getElementById("deleteComment").checked=!!c.data.can_delete,document.getElementById("dashboard-tenorkey").value=c.data.tenor_key,C("config").set("tenor_key",c.data.tenor_key)}),b=()=>{_(z,"/api/stats").token(x.getToken()).send().then(c=>{document.getElementById("count-comment").innerHTML=String(c.data.comments).replace(/\B(?=(\d{3})+(?!\d))/g,"."),document.getElementById("count-like").innerHTML=String(c.data.likes).replace(/\B(?=(\d{3})+(?!\d))/g,"."),document.getElementById("count-present").innerHTML=String(c.data.present).replace(/\B(?=(\d{3})+(?!\d))/g,"."),document.getElementById("count-absent").innerHTML=String(c.data.absent).replace(/\B(?=(\d{3})+(?!\d))/g,".")})},y=async c=>{let p=w.disableCheckbox(c);await _(G,"/api/user").token(x.getToken()).body({filter:!!c.checked}).send(),p.restore()},r=async c=>{let p=w.disableCheckbox(c);await _(G,"/api/user").token(x.getToken()).body({can_reply:!!c.checked}).send(),p.restore()},h=async c=>{let p=w.disableCheckbox(c);await _(G,"/api/user").token(x.getToken()).body({can_edit:!!c.checked}).send(),p.restore()},i=async c=>{let p=w.disableCheckbox(c);await _(G,"/api/user").token(x.getToken()).body({can_delete:!!c.checked}).send(),p.restore()},l=async c=>{let p=w.disableButton(c),$=document.getElementById("dashboard-tenorkey");$.disabled=!0,await _(G,"/api/user").token(x.getToken()).body({tenor_key:$.value.length?$.value:null}).send().then(()=>alert(`success ${$.value.length?"add":"remove"} tenor key`)),$.disabled=!1,p.restore()},u=async c=>{if(!confirm("Are you sure?"))return;let p=w.disableButton(c);await _(X,"/api/key").token(x.getToken()).send(O.statusResponse).then($=>{$.data.status&&m()}),p.restore()},I=async c=>{let p=document.getElementById("old_password"),$=document.getElementById("new_password");if(p.value.length===0||$.value.length===0){alert("Password cannot be empty");return}p.disabled=!0,$.disabled=!0;let N=w.disableButton(c),a=await _(G,"/api/user").token(x.getToken()).body({old_password:p.value,new_password:$.value}).send(O.statusResponse).then(n=>n.data.status,()=>!1);N.restore(),p.disabled=!1,$.disabled=!1,a&&(p.value=null,$.value=null,c.disabled=!0,alert("Success change password"))},T=async c=>{let p=document.getElementById("form-name");if(p.value.length===0){alert("Name cannot be empty");return}p.disabled=!0;let $=w.disableButton(c),N=await _(G,"/api/user").token(x.getToken()).body({name:p.value}).send(O.statusResponse).then(a=>a.data.status,()=>!1);p.disabled=!1,$.restore(),N&&(m(),c.disabled=!0,alert("Success change name"))},M=async c=>{let p=w.disableButton(c);await _(z,"/api/download").token(x.getToken()).download(),p.restore()},d=()=>{let c=document.getElementById("button-change-name");c.disabled&&(c.disabled=!1)},g=()=>{let c=document.getElementById("button-change-password"),p=document.getElementById("old_password");c.disabled&&p.value.length!==0&&(c.disabled=!1)},k=()=>{confirm("Are you sure?")&&J.clearSession()},B=()=>{oe.init(),Q.spyTop();let c=async()=>{await m(),b(),ee.init(),ee.show()};document.addEventListener("hidden.bs.modal",c);try{let p=window.location.href.split("?k=");p.length>1&&p[1].length>=1&&(x.setToken(p[1]),window.history.replaceState({},document.title,p[0]));let $=x.decode()?.exp;if(!$||$<Date.now()/1e3)throw new Error("Invalid token");c()}catch{J.clearSession()}};return{init:()=>(J.init(),Q.init(),x.init(),x.isAdmin()||(C("owns").clear(),C("likes").clear(),C("config").clear(),C("comment").clear(),C("session").clear(),C("information").clear()),window.addEventListener("DOMContentLoaded",B),{util:w,theme:Q,comment:ee,admin:{auth:J,navbar:ne,logout:k,tenor:l,download:M,regenerate:u,editComment:h,replyComment:r,deleteComment:i,changeName:T,changePassword:I,changeFilterBadWord:y,enableButtonName:d,enableButtonPassword:g}})}})();(m=>{m.undangan=ae.init()})(window);})();
